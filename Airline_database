
create table flight(flno int,from varchar(20),to varchar(20),distance int,departs date,arrives date,
price real,primary key(flno));

create table aircraft(aid int,aname varchar2(15),cruisingrange int,primary key(aid));

create table employees(eid int,ename varchar2(15),salary int,primary key(eid));

create table certified(eid int,aid int,primary key(eid,aid),foreign key (eid) references employees(eid),
foreign key (aid) references aircraft(aid));
commit;
 
insert into flight values(255,'BANGALORE','MUMBAI',200,'01-AUG-11','01-AUG-11',5000);
insert into flight values(256,'BANGALORE','FRANKFURT',400,'01-AUG-11','01-AUG-11',8000);
insert into flight values(257,'BANGALORE','DELHI',200,'01-AUG-11','01-AUG-11',5000);
insert into flight values(258,'BANGALORE','DELHI',200,'01-AUG-11','01-AUG-11',6000);
insert into flight values(259,'BANGALORE','MANGALORE',200,'01-AUG-11','01-AUG-11',4000);
commit;

select * from flight;

insert into aircraft values(685,'BOEING15',1000);
insert into aircraft values(686,'BOEING10',2000);
insert into aircraft values(687,'SKYTRAIN',1000);
insert into aircraft values(688,'AVENGER',100);
commit;

select * from aircraft;

insert into employees values(101,'ASHA',90000);
insert into employees values(102,'ARUN',85000);
insert into employees values(103,'ANAND',3000);
insert into employees values(104,'RAMYA',4000);
commit;

select * from employees;

insert into certified values(101,685);
insert into certified values(101,686);
insert into certified values(101,687);
insert into certified values(101,688);
insert into certified values(102,685);
insert into certified values(103,686);
insert into certified values(103,687);
commit;

select * from certified;

1>select a.aname from aircraft a where a.aid not in(select c.aid from certified c,
  employees e where c.eid=e.eid and e.salary<80000);
  commit;
  
2>select c.eid,max(a.cruiseingrange) from certified c,aircraft a 
  where c.aid=a.aid roup by c.eid having count(c.aid)>3;
  commit;
  
3>select ename from employees where salary <(select min(price) 
  from flight where from='BANGALORE' and to='FRANKFURT');
  commit;
  
4>select a.aname as name,avg(e.salary) as avgsal from aircraft a,certified c,employees e
  where a.aid=c.aid and c.eid=e.eid and cruiseingrange>1000 group by a.aid,a,aname;
  commit;
  
5>select distinct e.ename from employees e,certified c,aircraft a 
  where a.aid=c.aid and c.eid=e.eid and a.aname like 'BOEING15';
  commit;
  
6>select a.aid from aircraft a where a.cruiseingrange>(select min(distance)
  from flight where from='BANGALORE' and to='DELHI');
  commit;
  
8>SELECT E.ename, E.salary FROM Employees E WHERE E.eid NOT IN(SELECT DISTINCT C.eid FROM Certified C)AND E.salary 
> ( SELECT AVG (E1.salary) FROM Employees E1 WHERE E1.eid IN ( SELECT DISTINCT C1.eid FROM Certified C1 ) );
commit;
